<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Microbot-nrf APIs: DFU BLE packet handling in application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Microbot-nrf APIs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DFU BLE packet handling in application</div>  </div>
</div><!--header-->
<div class="contents">

<p>Handling of DFU BLE packets in the application.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae4d83224a562ad15ffced4e677a950c2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#gae4d83224a562ad15ffced4e677a950c2">DFU_APP_ATT_TABLE_POS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:gae4d83224a562ad15ffced4e677a950c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ba0681cf552c3b8f3ef9c1c35d49b29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#ga9ba0681cf552c3b8f3ef9c1c35d49b29">DFU_APP_ATT_TABLE_CHANGED</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga9ba0681cf552c3b8f3ef9c1c35d49b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga0c3ee265bb5b4a10eaf6018da68096f1"><td class="memItemLeft" align="right" valign="top"><a id="ga0c3ee265bb5b4a10eaf6018da68096f1"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#ga0c3ee265bb5b4a10eaf6018da68096f1">dfu_app_reset_prepare_t</a>) (void)</td></tr>
<tr class="memdesc:ga0c3ee265bb5b4a10eaf6018da68096f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU application reset_prepare function. This function is a callback that allows the application to prepare for an upcoming application reset. <br /></td></tr>
<tr class="separator:ga0c3ee265bb5b4a10eaf6018da68096f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#ga0b5bc3c6d3daca444ec05d33d065f369">dfu_app_on_dfu_evt</a> (<a class="el" href="structble__dfu__s.html">ble_dfu_t</a> *p_dfu, <a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a> *p_evt)</td></tr>
<tr class="memdesc:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for handling events from the DFU Service.  <a href="#ga0b5bc3c6d3daca444ec05d33d065f369">More...</a><br /></td></tr>
<tr class="separator:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#ga46ec5bb0ed70dfa3207ba06a25ce2347">dfu_app_reset_prepare_set</a> (<a class="el" href="group__nrf__dfu__app__handler.html#ga0c3ee265bb5b4a10eaf6018da68096f1">dfu_app_reset_prepare_t</a> reset_prepare_func)</td></tr>
<tr class="memdesc:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for registering a function to prepare a reset.  <a href="#ga46ec5bb0ed70dfa3207ba06a25ce2347">More...</a><br /></td></tr>
<tr class="separator:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba97df0355824c35283c712ebdbedd68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nrf__dfu__app__handler.html#gaba97df0355824c35283c712ebdbedd68">dfu_app_dm_appl_instance_set</a> (dm_application_instance_t app_instance)</td></tr>
<tr class="memdesc:gaba97df0355824c35283c712ebdbedd68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for setting the Device Manager application instance.  <a href="#gaba97df0355824c35283c712ebdbedd68">More...</a><br /></td></tr>
<tr class="separator:gaba97df0355824c35283c712ebdbedd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Handling of DFU BLE packets in the application. </p>
<p>This module implements the handling of DFU packets for switching from an application to the bootloader and start DFU mode. The DFU packets are transmitted over BLE. This module handles only the StartDFU packet, which allows a BLE application to expose support for the DFU Service. The actual DFU Service runs in a dedicated environment after a BLE disconnect and reset of the  device. The host must reconnect and continue the update procedure with access to the full DFU Service.</p>
<dl class="section note"><dt>Note</dt><dd>The application must propagate DFU events to this module by calling <a class="el" href="group__nrf__dfu__app__handler.html#ga0b5bc3c6d3daca444ec05d33d065f369">dfu_app_on_dfu_evt</a> from the <a class="el" href="group__ble__sdk__srv__dfu.html#gaec23b4e8bbe78a643e7cb9e9c02ca681">ble_dfu_evt_handler_t</a> callback. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga9ba0681cf552c3b8f3ef9c1c35d49b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ba0681cf552c3b8f3ef9c1c35d49b29">&#9670;&nbsp;</a></span>DFU_APP_ATT_TABLE_CHANGED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DFU_APP_ATT_TABLE_CHANGED&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Value indicating that the ATT table might have changed. This value will be set in the application-specific context in Device Manager when entering DFU mode. </p>

<p class="definition">Definition at line <a class="el" href="dfu__app__handler_8h_source.html#l00043">43</a> of file <a class="el" href="dfu__app__handler_8h_source.html">dfu_app_handler.h</a>.</p>

</div>
</div>
<a id="gae4d83224a562ad15ffced4e677a950c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4d83224a562ad15ffced4e677a950c2">&#9670;&nbsp;</a></span>DFU_APP_ATT_TABLE_POS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DFU_APP_ATT_TABLE_POS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Position for the ATT table changed setting. </p>

<p class="definition">Definition at line <a class="el" href="dfu__app__handler_8h_source.html#l00042">42</a> of file <a class="el" href="dfu__app__handler_8h_source.html">dfu_app_handler.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaba97df0355824c35283c712ebdbedd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba97df0355824c35283c712ebdbedd68">&#9670;&nbsp;</a></span>dfu_app_dm_appl_instance_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_dm_appl_instance_set </td>
          <td>(</td>
          <td class="paramtype">dm_application_instance_t&#160;</td>
          <td class="paramname"><em>app_instance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for setting the Device Manager application instance. </p>
<p>This function allows to set the dm_application_instance_t value that is returned by the Device Manager when the application registers using dm_register. If this function is not called, it is not be possible to share bonding information from the application to the bootloader/DFU when entering DFU mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">app_instance</td><td>Value for the application instance in use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0b5bc3c6d3daca444ec05d33d065f369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b5bc3c6d3daca444ec05d33d065f369">&#9670;&nbsp;</a></span>dfu_app_on_dfu_evt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_on_dfu_evt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structble__dfu__s.html">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a> *&#160;</td>
          <td class="paramname"><em>p_evt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for handling events from the DFU Service. </p>
<p>The application must inject this function into the DFU Service or propagate DFU events to the dfu_app_handler module by calling this function in the application-specific DFU event handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU Service structure to which the include event relates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_evt</td><td>Pointer to the DFU event. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga46ec5bb0ed70dfa3207ba06a25ce2347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga46ec5bb0ed70dfa3207ba06a25ce2347">&#9670;&nbsp;</a></span>dfu_app_reset_prepare_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_reset_prepare_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__nrf__dfu__app__handler.html#ga0c3ee265bb5b4a10eaf6018da68096f1">dfu_app_reset_prepare_t</a>&#160;</td>
          <td class="paramname"><em>reset_prepare_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for registering a function to prepare a reset. </p>
<p>The provided function is executed before resetting the system into bootloader/DFU mode. By registering this function, the caller is notified before the reset and can thus prepare the application for reset. For example, the application can gracefully disconnect any peers on BLE, turn of LEDS, ensure that all pending flash operations have completed, and so on.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reset_prepare_func</td><td>Function to be executed before a reset. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
