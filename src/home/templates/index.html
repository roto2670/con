{% extends "base_site.html" %}

{% block title %} {{ current_product.name }} {% endblock title %}

{% block stylesheets %}
  {{ super() }}
{% endblock stylesheets %}

{% block content %}


  <div class="right_col" role="main">
    <!-- top tiles -->
    <div class="row tile_count">
      <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
        <span class="count_top"><i class="fa fa-user"></i> Total Users</span>
        <div class="count">{{ infos['total_users'] }}</div>
      </div>
      <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
        <span class="count_top"><i class="fa fa-cubes"></i> Total Gadgets</span>
        <div class="count">{{ infos['total_gadgets'] }}</div>
      </div>
      <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
        <span class="count_top"><i class="fa fa-circle"></i> Online</span>
        <div class="count">{{ infos['online'] }}</div>
      </div>
      <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
        <span class="count_top"><i class="fa fa-exclamation-circle"></i> Offline</span>
        <div class="count">{{ infos['offline'] }}</div>
      </div>
    </div>
    <!-- /top tiles -->

    <br />

    <div class="row">

      <div class="col-md-4 col-sm-4 col-xs-12">
        <div class="x_panel tile fixed_height_320">
          <div class="x_title">
            <h2>Firmware Version</h2>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <h4>Firmware Usage across versions</h4>
            {% for key, value in infos['firmware'].items() %}
              <div class="widget_summary">
                <div class="w_left w_25">
                  <span>{{ key }}</span>
                </div>
                <div class="w_center w_55">
                  <div class="progress">
                    <div class="progress-bar bg-green" role="progressbar" aria-valuenow="{{ ((value / infos['total_firmware']) * 100)|int }}"
                       aria-valuemin="0" aria-valuemax="100" style="width: {{ ((value / infos['total_firmware']) * 100)|int }}%;">
                      <span class="sr-only">{{ value }}</span>
                    </div>
                  </div>
                </div>
                <div class="w_right w_20">
                  <span>{{ value }}</span>
                </div>
                <div class="clearfix"></div>
              </div>
            {% endfor %}

          </div>
        </div>
      </div>

      <div class="col-md-4 col-sm-4 col-xs-12">
        <div class="x_panel tile fixed_height_320 overflow_hidden">
          <div class="x_title">
            <h2>Connected Device</h2>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <table class="" style="width:100%">
              <tr>
                <th style="width:37%;">
                </th>
                <th>
                  <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7">
                  </div>
                </th>
              </tr>
              <tr>
                <td>
                  <canvas id="canvasDoughnut1" class="canvasDoughnut1" height="200" width="200" style="margin: 15px 10px 10px 0"></canvas>
                </td>
                <td>
                  <table class="tile_info">
                    <tr>
                      <td>
                        <p><i class="fa fa-square blue"></i>On </p>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <p><i class="fa fa-square red"></i>Off </p>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <div class="col-md-4 col-sm-4 col-xs-12">
        <div class="x_panel tile fixed_height_320">
          <div class="x_title">
            <h2>Battery Average</h2>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <div class="dashboard-widget-content">
              <div class="center-margin center-align">
                  <canvas width="250" height="140" id="chart_gauge_001" class="" style="height: 140px;"></canvas>
                  <div class="goal-wrapper">
                    <span id="gauge-text001" class="gauge-value">0</span>
                    <span class="gauge-value">%</span>
                    <span id="goal-text" class="goal-value margin-left-10em">100%</span>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>


      <!--

    <div class="row">
        <div class="col-md-4 col-sm-4 col-xs-12">
            <div class="x_panel tile fixed_height_320">
              <div class="x_title">
                <h2>Name</h2>
                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                <div class="dashboard-widget-content">
                  <div class="center-margin center-align">
                      <canvas width="250" height="140" id="word-cloud" class="" style="width: 140px;height: 140px;"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
    </div>
      -->

  </div>
{% endblock content %}

{% block javascripts %}
  {{ super()}}
  <!-- Chart.js -->
  <script src="{{ url_for('static', filename='vendors/Chart.js/dist/Chart.min.js') }}"></script>
  <!-- gauge.js -->
  <script src="{{ url_for('static', filename='vendors/gauge.js/dist/gauge.min.js') }}"></script>
  <!-- Skycons -->
  <script src="{{ url_for('static', filename='vendors/skycons/skycons.js') }}"></script>
  <!-- Flot -->
  <script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.pie.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.time.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.stack.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.resize.js') }}"></script>
  <!-- Flot plugins -->
  <script src="{{ url_for('static', filename='vendors/flot.orderbars/js/jquery.flot.orderBars.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/flot-spline/js/jquery.flot.spline.min.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/flot.curvedlines/curvedLines.js') }}"></script>
  <!-- DateJS -->
  <script src="{{ url_for('static', filename='vendors/DateJS/build/date.js') }}"></script>
  <!-- JQVMap -->
  <script src="{{ url_for('static', filename='vendors/jqvmap/dist/jquery.vmap.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/jqvmap/dist/maps/jquery.vmap.world.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/jqvmap/examples/js/jquery.vmap.sampledata.js') }}"></script>
  <!-- D3 cloud -->
  <script src="{{ url_for('static', filename='vendors/d3/d3.min.js') }}"></script>
  <script src="{{ url_for('static', filename='vendors/d3-cloud/build/d3.layout.cloud.js') }}"></script>

  <script>
    function connectionGraph(offData, onData) {
      var ctx = document.getElementById("canvasDoughnut1");
        var data = {
          labels: [
            "Off",
            "On"
          ],
          datasets: [{
            data: [offData, onData],
            backgroundColor: [
              "#E74C3C",
              "#3498DB"
            ],
            hoverBackgroundColor: [
              "#E95E4F",
              "#49A9EA"
            ]
          }]
        };
        var options = {
          legend: false,
          responsive: false
        }

        var canvasDoughnut1 = new Chart(ctx, {
          type: 'doughnut',
          tooltipFillColor: "rgba(51, 51, 51, 0.55)",
          data: data,
          options: options
        });

    }
    connectionGraph('{{ infos["offline"] }}', '{{ infos["online"] }}');

    function averageBattery(battery) {
      var chart_gauge_settings = {
        lines: 12,
        angle: 0,
        lineWidth: 0.4,
        pointer: {
          length: 0.5,
          strokeWidth: 0.042,
          color: '#1D212A'
        },
        limitMax: 'true',
        colorStart: '#1ABC9C',
        colorStop: '#1ABC9C',
        strokeColor: '#F0F3F3',
        generateGradient: true
      };
        var chart_gauge_001_elem = document.getElementById('chart_gauge_001');
        var chart_gauge_001 = new Gauge(chart_gauge_001_elem).setOptions(chart_gauge_settings);
        chart_gauge_001.maxValue = 100;
        chart_gauge_001.setMinValue(0);
        chart_gauge_001.animationSpeed = 20;
        chart_gauge_001.set(parseInt(battery));
        chart_gauge_001.setTextField(document.getElementById("gauge-text001"));
    }
    averageBattery('{{ infos["avg_battery"] }}');

    function nameCloud(nameList) {
      test = [{"word": "hi"}, {"word": "hello"}]

      d3.layout.cloud().size([500,500])
        .words(test.map(function(d) {
          return {text: d.word, size: 0};
        }))
        .on("end", draw)
        .start();

      function draw(words) {
        d3.select("word-cloud").append("svg")
          .attr("width", 300)
          .attr("height", 300)
          .append("g")
          .selectAll("text")
          .data(words)
          .enter().append("text")
          .text(function(d) { return d.text; });
      }
    }
    nameCloud('{{ infos["name_list"] }}');

  </script>

{% endblock javascripts %}
